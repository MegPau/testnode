extends layout

block head
  // Here will go our css/js links
  script(type="text/javascript" src="/js/jquery-3.2.1.min.js" charset="utf-8")
  script(type="text/javascript" src="/js/bootstrap.min.js" charset="utf-8")
  script(type="text/javascript" src="/js/index.js" charset="utf-8")
  link(rel='stylesheet', href='/css/bootstrap.min.css')
  link(rel='stylesheet', href='/css/bootstrap-theme.min.css')

block content  
  div.container
    div.col-md-6.col-md-offset-3
      p #{text}
      button#show-metrics(type="button" class="btn btn-success") Bring the metrics
      #metrics
    button.btn.btn-danger(href='/logout' onClick='document.location.href="/logout"') Logout
    div
    
      
  script 
    :coffee-script
      $('#show-metrics').click (e) ->      
        e.preventDefault()
        $.getJSON "/usermetrics.json", {}, (data) ->
          for d in data
            $.getJSON "/metrics.json/#{d.id}", {}, (dataMetrics) ->
              console.log "got metrics : #{dataMetrics}"
              content = "<ul>"
              for dm in dataMetrics
                content += "<li>timestamp: #{dm.timestamp}, value: #{dm.value}</li>"
              content += "</ul>"
              $('#metrics').append content
          
        ###$.getJSON "/metrics.json", {}, (data) ->
        console.log "got metrics : #{data}"
        content = "<ul>"
        for d in data
          content += "<li>timestamp: #{d.timestamp}, value: #{d.value}</li>"
          content += "</ul>"
          $('#metrics').append content###
